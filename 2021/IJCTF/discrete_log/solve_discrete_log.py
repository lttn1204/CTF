from pwn import *
from Crypto.Util.number import *
p=connect('35.244.0.8', 34712)
p.recvuntil(b'Mod: ')
mod=int(p.recvline())
p.recvuntil(b'Here is RSA encrypted flag.(e=65537)\n')
enc=int(p.recvline())
p.recvuntil(b'base: ')
c_=pow(enc,65537,mod)
p.sendline(str(c_))
p.recvuntil(b'number: ')
p.sendline(str(enc))
p.recvuntil(b'Here is the discrete log: ')
d=int(p.recvline()[:-1])
print(long_to_bytes(pow(enc,d,mod)))
